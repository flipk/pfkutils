
LIB= libbt.a
HDRS= recnoblock.H btree.H
SRCS= recnoblock.C btree.C print_tree.C
ALLSRCS= $(SRCS) test.C
OBJS= $(SRCS:.C=.o)
FLAGS= -O3
INCS=  -I../threads/h -I../dll2 -I.. -I../util

all: $(LIB) rbt rbto

$(LIB): $(OBJS)
	rm -f $(LIB)
	ar cq $(LIB) $(OBJS)
	ranlib $(LIB)

rbt: recnoblock.C
	g++ -g3 $(INCS) -DINCLUDE_MAIN recnoblock.C ../dll2/libdll2.a -o rbt

rbto: recnoblock.C
	g++ -O3 $(INCS) -DINCLUDE_MAIN recnoblock.C ../dll2/libdll2.a -o rbto

tests:: t1 t2 t3 t4 t5 t6 t7


t1: test.C $(LIB)
	g++ test.C -DTEST=1 $(INCS) $(FLAGS) $(LIB) -o $*

t2: test.C $(LIB)
	g++ test.C -DTEST=2 $(INCS) $(FLAGS) $(LIB) -o $*

t3: test.C $(LIB)		 
	g++ test.C -DTEST=3 $(INCS) $(FLAGS) $(LIB) -o $*

t4: test.C $(LIB)		 
	g++ test.C -DTEST=4 $(INCS) $(FLAGS) $(LIB) -o $*

t5: test.C $(LIB)		 
	g++ test.C -DTEST=5 $(INCS) $(FLAGS) $(LIB) -o $*

t6: test.C $(LIB)		 
	g++ test.C -DTEST=6 $(INCS) $(FLAGS) $(LIB) -o $*

t7: test.C $(LIB)		 
	g++ test.C -DTEST=7 $(INCS) $(FLAGS) $(LIB) -o $*

.C.o:
	gcc $(INCS) $(FLAGS) -c $*.C

clean:
	rm -f *.o $(LIB) img t? t?.exe Makefile *core

depend: Makefile.in $(SRCS) $(HDRS)
	awk 'BEGIN { copy=1; } { if ( copy ) print } /^#DEPENDENCIES/ { copy=0; }' < Makefile > x
	gcc -M $(INCS) $(SRCS) >> x
	mv x Makefile

#DEPENDENCIES
